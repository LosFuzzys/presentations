{\usebackgroundtemplate{\includegraphics[height=\paperheight]{./images/zippy/bugs/buggybugs-1.jpg}}
\begin{frame}[t,plain]
    \titlepage
\end{frame}
}

\begin{frame}
  {\texttt{\$ who}}

  \begin{columns}
    \begin{column}{0.48\textwidth}
      {\texttt{@f0rki}}
      \begin{itemize}
        \item f0rki@hack.more.systems
        \item CS/InfoSec Student
        \item CTF Player since 2010
      \end{itemize}
    \end{column}

    \begin{column}{0.48\textwidth}
      \texttt{@stefan2904}
      \begin{itemize}
        \item stefan@hack.more.systems
        \item CS/InfoSec/CI Student
        \item CTF Player since 2014
      \end{itemize}
    \end{column}
  \end{columns}

\end{frame}


%\begin{frame}{stuff we are gonna be talking about \ldots}
%    \tableofcontents
%\end{frame}


\section{Introduction to CTFs}

\begin{frame}[fragile,plain]
	 \begin{center}
	 	\Huge\verb+CTF{THIS_IS_A_FLAG}+
	 \end{center}
\end{frame}

\begin{frame}[fragile]
  {CTF: Capture The Flag}

  \begin{itemize}
    \item Collaborative hacking competitions
    \begin{itemize}
    	\item Teams vs. Teams
    \end{itemize}
    \item The goal is to capture flags
  \end{itemize}
\end{frame}

\begin{frame}
  {CTF Type: Jeopardy}

  \begin{figure}[h]
    \centering
    %\includegraphics[width=\textwidth]{./images/dctf-challenges.png}
    \includegraphics[height=0.8\textheight]{./images/sharifctf-challenges.jpg}
    \caption{\footnotesize{}Sharif CTF Challenge Board}
    \label{fig:jeopardyboard}
  \end{figure}
\end{frame}

\begin{frame}
  {CTF Type: Attack-Defense}

  \begin{figure}[h]
    \centering
    \includegraphics[width=0.9\textwidth]{./images/ructf-network.png}
    \caption{\footnotesize
      RUCTFe 2015 Network Schema (source:
      \href{https://ructf.org/e/2015/network.html}{RUCTF org}) }
  \end{figure}
\end{frame}

\begin{frame}
  {CTF Type: Attack-Defense}

  \begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{./images/faustctf-scoreboard.png}
    \caption{\footnotesize{}FAUST CTF 2015 scoreboard}
    \label{fig:faustctfscoreboard}
  \end{figure}

\end{frame}


\begin{frame}
  {Why CTFs?}

  \begin{itemize}
    \item \textbf{It's fun!}
    \item Gain experience in Information Security
    \item Challenges modeled after real-world problems
      \begin{itemize}
        \item Sometimes real-world bugs modeled after CTF bugs?
      \end{itemize}
  \end{itemize}
\end{frame}

\section{LosFuzzys}

{\usebackgroundtemplate{\includegraphics[height=\paperheight]{./images/zippy/bugs/buggybugs-20.jpg}}
\begin{frame}[allowframebreaks,plain]

  {\huge
    \texttt{LosFuzzys}: A CTF Team in Graz}

  \vspace{19em}

  {\Large
  We Like Bugs!}

\end{frame}
}

\begin{frame}
  {LosFuzzys: A CTF Team in Graz}

  \begin{itemize}
    \item \url{https://hack.more.systems}
      \\ twitter: \href{https://twitter.com/LosFuzzys}{@LosFuzzys}
    \item A group of people interested in information security
    \item Primarily CS/SW/ICE Students from TUGraz
      \begin{itemize}
        \item But we welcome anyone interested and motivated :)
        \item and maybe even you ;)
      \end{itemize}
    \item Irregular Meet-ups
  \end{itemize}
\end{frame}

\begin{frame}
	{Where to start?}

	\begin{itemize}
		\item Talk to us! :-)
	\end{itemize}

	\begin{itemize}
		\item Read writeups!
		\begin{itemize}
			\item Repo: \href{https://github.com/ctfs}{github.com/ctfs}
			\item Ours: \href{https://hack.more.systems/writeups}{hack.more.systems/writeups}
		\end{itemize}
	\end{itemize}

\end{frame}


\section{CTF Toolbox}

{\usebackgroundtemplate{\includegraphics[height=\paperheight]{./images/zippy/bugs/buggybugs-14.jpg}}
\begin{frame}[plain]

  \begin{center}
    {\Huge \hspace*{\fill} \textbf{CTF Toolbox}}

    \vspace{17em}
  \end{center}
\end{frame}
}

\begin{frame}
  {CTF Toolbox}

  \begin{itemize}
    \item Great diversity of challenges
    \item Some things turn up frequently
    \item Knowledge of technology necessary
    \item Experience helps a lot
  \end{itemize}

  \begin{itemize}
    \item Using the right tools is essential
      \begin{itemize}
        \item assuming you know how to use them\ldots
      \end{itemize}
  \end{itemize}

\end{frame}

%\begin{frame}
%  {CTF approach}

%  \Large
%  \begin{enumerate}
%    \item Analyze
%    \item Attack
%    \item Retrieve
%  \end{enumerate}
%\end{frame}

%{\usebackgroundtemplate{\includegraphics[height=\paperheight]{./images/automatealltheexploits.jpg}}
%\begin{frame}[plain]

%  %{\Huge Automation}
%\end{frame}}

\begin{frame}
  {Scripting is your best Friend}

  \begin{itemize}
    \item Be comfortable in automating things
    \item Use whatever works best
      \begin{itemize}
        \item bash, zsh etc.
        \item Python, Ruby etc.
      \end{itemize}
  \end{itemize}

  \begin{center}
    \includegraphics[height=0.5\textheight]{./images/automatealltheexploits.jpg}
  \end{center}
\end{frame}


\begin{frame}
  {Command-Line-Fu is very helpful}

  \begin{itemize}
    \item Standard utils -- \texttt{grep, sed, awk, sort, cut, uniq,} \ldots
    \item Network stuff -- \texttt{nc, socat, dig, nmap}
    \item Query json -- \texttt{jq}
    \item HTTP -- \texttt{curl}
    \item \ldots
  \end{itemize}

  \begin{itemize}
    \item Pipe together to get your results!
  \end{itemize}
\end{frame}


%\begin{frame}
%  \todo[inline]{Some example with socat?}
%\end{frame}


\begin{frame}[fragile]
  {Bash Password Guessing}

  \begin{lstlisting}[language=bash]
for x in q w e r t y u i o p a s d f g h j k l z \
    x c v b n m Q W E R T Y U I O P A S D F G H J \
    K L Z X C V B N M 1 2 3 4 5 6 7 8 9 0 "-" "_" "?"
do
echo "= $x ="
# count sigaction syscalls
strace ./stage3.bin "Did_you_l$x$x$x$x$x$x$x$x" 2>&1 \
  | grep sigaction \
  | wc -l
done > log
# get highest count of sigactions and triggering char
cat log | grep -B 1 \
  "$(cat log | grep -v = | sort | uniq | tail -n 1)"
  \end{lstlisting}

\end{frame}

%\begin{frame}
%  \todo[inline]{add command line black-magic example}
%\end{frame}

% python requests - automated browsing

\begin{frame}[fragile]
  {Automated Browsing -- python-requests}

  \begin{lstlisting}[language=python]
import requests

URL = 'http://ctf.example.com'
s = requests.session()
r = s.post(URL + '/login',
           data={'user': 'fuzzy', 'pass': '1234'})

# GET http://ctf.example.com/vuln?x='or%201=1--x
resp = s.get(URL + '/vuln',
             params={'x': '\'or 1=1 --x'})
# session cookie automagically used here

print resp.text
# flag{some_flag_of_some_service}
  \end{lstlisting}
\end{frame}

% pwntools - implement parts of line-based network protocols

\begin{frame}[fragile]
  {Dirty Networking -- pwntools}

% TODO: send email or something
  \begin{lstlisting}[language=python]
from pwn import *

r = remote('ctf.example.com', 1337)

# line based
r.recvline()
r.sendline('HELO %s%s%s%s')
r.recvuntil('250 Hello')

data = r.recv(4)

# unpack LE uint32 from bin
i = u32(data)
log.info('received uint32 {}'.format(i))

# pack BE uint32 to bin
r.send(p32(1094795585, endian='big'))
r.recvline()
  \end{lstlisting}
\end{frame}



{\usebackgroundtemplate{\includegraphics[height=\paperheight]{./images/zippy/bugs/buggybugs-23.jpg}}
\begin{frame}[plain]

  {\huge Finding \& Analyzing Vulnerabilities}

  \vspace{16em}

\end{frame}
}


\begin{frame}[fragile]
  {Analyzing Java/.NET Apps}

  \begin{itemize}
    \item Great decompilers!
      \note{
      \begin{itemize}
        \item Bytecode much easier to decompile.
      \end{itemize}}
    \item Java/Dalvik bytecode
      \begin{itemize}
        \item intellij built-in decompiler (fernflower),
          \href{https://bitbucket.org/mstrobel/procyon/}{procyon}
        \item \url{http://www.javadecompilers.com/}
      \end{itemize}
    \item Android apps/Dalvik bytecode
      \begin{itemize}
        \item \href{http://ibotpeaches.github.io/Apktool/}{apktool},
          \href{https://bitbucket.org/JesusFreke/smali/}{smali/baksmali},
          \href{https://github.com/skylot/jadx}{jadx}
        \item Xposed
      \end{itemize}
    \item .NET bytecode
      \begin{itemize}
        \item \href{http://ilspy.net/}{ILSpy}, \href{https://www.jetbrains.com/decompiler/}{Jetbrains dotPeek}
      \end{itemize}

  \end{itemize}

\end{frame}


\input{binary}


%\begin{frame}[plain]

%  {\Huge Cryptography}
%\end{frame}

% sagemath - crypto all the things

{
\usebackgroundtemplate{\includegraphics[width=\paperwidth]{./images/zippy/cryptobugs/cryptobug10.jpg}}
\begin{frame}[fragile,plain]

  %\pgfsetfillopacity{0.5}
  %\setbeamercolor{boxcolor}{fg=white,bg=black}
  %\begin{beamercolorbox}[sep=1em,wd=\textwidth]{boxcolor}
  %\pgfsetfillopacity{1}
  %\end{beamercolorbox}

  \vspace{19em}

  \hspace*{\fill}{\Huge Cryptography}

	%{Crypto? Sage, Pen and Paper to the rescue!}

%  \pgfsetfillopacity{0.5}
%  \setbeamercolor{boxcolor}{fg=white,bg=black}
%  \begin{beamercolorbox}[sep=0.5em,wd=10cm]{boxcolor}
%  	\pgfsetfillopacity{1}
%	  \begin{lstlisting}[language=python]
%		n1 = 0xD564B978F9D233504958EED8B7 ...
%		...
%
%		factors1 = factor(n1)
%		p1 = list(factors1)[0][0]
%		q1 = list(factors1)[1][0]
%
%		e = 65537
%		c1 = 0x0caf5db76313c9b32a473fcdd91 ...
%		...
%		phi1 = (p1 - 1) * (q1 -1)
%		...
%		bezout1 = xgcd(e, phi1)
%		...
%		d1 = Integer(mod(bezout1[1], phi1))
%		...
%		m1 = power_mod(c1,d1,n1)
%		...
%	  \end{lstlisting}
%	\end{beamercolorbox}
\end{frame}
}

\begin{frame}
  {Crypto Tools}

  \begin{itemize}
    \item Pen \& Paper
  \end{itemize}
  \begin{itemize}
    \item \texttt{\href{http://www.sagemath.org/}{sage}}
      \begin{itemize}
        \item CAS \& python
      \end{itemize}
    \item packages implementing attacks, e.g.
      \begin{itemize}
        \item \href{http://mwielgoszewski.github.io/python-paddingoracle/}
          {python-paddingoracle}
        \item \href{https://github.com/bwall/HashPump}{hashpumpy} (hash length extension attack)
        \item \ldots
      \end{itemize}
  \end{itemize}
\end{frame}

% pen & paper - never underestimate

%\begin{frame}
%
%  \todo[inline]{something, something about pen \& paper}
%\end{frame}


\begin{frame}
  {Learn to Improvise}

  \begin{itemize}
    \item Premature optimization* is the root of all evil!
      \begin{itemize}
        \item * also commenting code
        \item * also clean code
      \end{itemize}
    \item (only true for attack \&\&  \emph{during} CTFs!)
    \item If it works once, \ldots it works!
    \item Code-reuse between different CTFs!
      \begin{itemize}
        \item Post-CTF code cleanup would be good\ldots
      \end{itemize}
  \end{itemize}

\end{frame}

\begin{frame}[plain]
	\begin{center}
		\huge A fool with a tool is still a fool!
	\end{center}
\end{frame}

{
\usebackgroundtemplate{\includegraphics[height=\paperheight]{./images/zippy/bugs/buggybugs-1.jpg}}
\begin{frame}[plain]

  \begin{center}
  	\pgfsetfillopacity{0.5}
  	\setbeamercolor{boxcolor}{fg=white,bg=black}
  	\begin{beamercolorbox}[sep=0.5em,wd=10cm]{boxcolor}
  		\pgfsetfillopacity{1}
	    \color{white}
	    {\huge \url{https://hack.more.systems}}
	\end{beamercolorbox}
  \end{center}

  \vspace{3em}


  \pgfsetfillopacity{0.5}
  \setbeamercolor{boxcolor}{fg=white,bg=black}
  \begin{beamercolorbox}[sep=1em,wd=5cm]{boxcolor}
  \pgfsetfillopacity{1}
    Thanks to

    \begin{itemize}
      \item all LosFuzzys members
      \item IAIK's SASE Team
      \item realraum Graz
      \item \url{tuflowgraphy.at}
    \end{itemize}
  \end{beamercolorbox}

\end{frame}
}

\begin{frame}
  {Writeups of Used Examples}

  \begin{itemize}
    \item \url{https://hack.more.systems/writeups}
  \end{itemize}

  \begin{itemize}
    \item
      \href{http://losfuzzys.github.io/writeup/2015/12/07/9447ctf-premonition/}
      {9447ctf: premonition (web)}
    \item \href{https://losfuzzys.github.io/writeup/2016/04/04/ndhquals2016-matriochka/}
      {NDH quals 2016: matriochka (reversing)}
    \item \href{https://losfuzzys.github.io/writeup/2016/04/04/ndhquals2016-secure-file-reader/}
      {NDH quals 2016: secure file reader (pwn)}
    %\item \href{http://losfuzzys.github.io/writeup/2016/02/20/iwctf2016-oh-bob/}
    %  {Internetwache CTF 2016: Oh Bob! (crypto 60)}
  \end{itemize}

\end{frame}
